<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Tabu Search TEA: /Users/freddy/Documents/Research_projects/TEA/code/tabu_search.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.7 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>Globals</span></a></li>
  </ul></div>
<h1>/Users/freddy/Documents/Research_projects/TEA/code/tabu_search.c</h1><a href="tabu__search_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00009"></a>00009 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00010"></a>00010 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00011"></a>00011 <span class="preprocessor">#include &lt;limits.h&gt;</span>
<a name="l00012"></a>00012 <span class="preprocessor">#include &lt;time.h&gt;</span>
<a name="l00013"></a>00013 
<a name="l00014"></a>00014 <span class="preprocessor">#include "<a class="code" href="tabu__search_8h.html">tabu_search.h</a>"</span>
<a name="l00015"></a>00015 <span class="preprocessor">#include "<a class="code" href="tea_8h.html">tea.h</a>"</span>
<a name="l00016"></a>00016 <span class="preprocessor">#include "<a class="code" href="io_8h.html">io.h</a>"</span>
<a name="l00017"></a>00017 <span class="preprocessor">#include "<a class="code" href="types_8h.html">types.h</a>"</span>
<a name="l00018"></a>00018 
<a name="l00048"></a><a class="code" href="tabu__search_8h.html#e49ba6492667d5ff87febb12ee3fd63e">00048</a> <span class="keywordtype">void</span> <a class="code" href="tabu__search_8c.html#6923e47c8f97b184b285c378c83a2a81">move_alpha</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *key,<a class="code" href="structtabu__list.html">tabu_list</a> *list,<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *mistakes,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *control,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *founded,<a class="code" href="structbest__result.html">best_result</a> *best,<a class="code" href="structtabu__search__params.html">ts_params</a> *params,<a class="code" href="structoutput__report.html">output_report</a> *report,<a class="code" href="structcontainer__node.html">cipher_cont</a> *cpmess,<span class="keywordtype">int</span> block)
<a name="l00049"></a>00049 {
<a name="l00050"></a>00050         
<a name="l00051"></a>00051         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i,j;
<a name="l00052"></a>00052         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> bits=2;
<a name="l00053"></a>00053         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> keys[<a class="code" href="tabu__search_8h.html#de156992e10805c7e09be844b7780c79">TEA_DUAL_BLOCK</a>];<span class="comment">/*&lt; where to put key changes*/</span>
<a name="l00054"></a>00054         <span class="keywordtype">float</span> scores[<a class="code" href="tabu__search_8h.html#de156992e10805c7e09be844b7780c79">TEA_DUAL_BLOCK</a>];      <span class="comment">/*&lt; where to put the scores*/</span>
<a name="l00055"></a>00055         <span class="keywordtype">float</span> score=0;
<a name="l00056"></a>00056         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tabu=<a class="code" href="types_8h.html#a93f0eb578d23995850d61f7d61c55c1">FALSE</a>;           <span class="comment">/*&lt; if tabu move */</span>
<a name="l00057"></a>00057         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> position=0;
<a name="l00058"></a>00058         
<a name="l00059"></a>00059         <span class="comment">/* if this key block has been founded, then skip all operations */</span>
<a name="l00060"></a>00060         <span class="keywordflow">if</span>(*founded!=<a class="code" href="types_8h.html#a93f0eb578d23995850d61f7d61c55c1">FALSE</a>)
<a name="l00061"></a>00061         {
<a name="l00062"></a>00062                 <span class="keywordflow">return</span>;
<a name="l00063"></a>00063         }
<a name="l00064"></a>00064         <span class="comment">/*   32 bits for the key block    */</span>
<a name="l00065"></a>00065         <span class="keywordflow">for</span>(i=0;i&lt;<a class="code" href="tabu__search_8h.html#de156992e10805c7e09be844b7780c79">TEA_DUAL_BLOCK</a>;i++)
<a name="l00066"></a>00066         {
<a name="l00067"></a>00067                 scores[i]=-<a class="code" href="tabu__search_8h.html#30a84777ef6bc779f7c1c5942575a5fc">POST_LIMIT</a>;
<a name="l00068"></a>00068                 <span class="comment">/* check tabu list for this tabu movement */</span>
<a name="l00069"></a>00069                 <span class="keywordflow">for</span>(j=0;j&lt;params-&gt;<a class="code" href="structtabu__search__params.html#7f49d4ec523597ea9ddb839f80fbe2a8">tabu_list_length</a>;j++)
<a name="l00070"></a>00070                 {
<a name="l00071"></a>00071                         <span class="keywordflow">if</span>(list-&gt;<a class="code" href="structtabu__list.html#07a15f07895c76ee5acf99b3a1cb77be">bit_position</a>==i)
<a name="l00072"></a>00072                         {
<a name="l00073"></a>00073                                 tabu=<a class="code" href="types_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00074"></a>00074                                 <span class="keywordflow">break</span>;
<a name="l00075"></a>00075                         }
<a name="l00076"></a>00076                         list=list-&gt;<a class="code" href="structtabu__list.html#0e67af91d43756f1e998bd52351220df">next</a>;
<a name="l00077"></a>00077                 }
<a name="l00078"></a>00078                 <span class="keywordflow">if</span>(tabu==<a class="code" href="types_8h.html#a93f0eb578d23995850d61f7d61c55c1">FALSE</a>)
<a name="l00079"></a>00079                 {
<a name="l00080"></a>00080                         <span class="comment">/* movement for the left key block */</span>
<a name="l00081"></a>00081                         <span class="keywordflow">if</span>(block==<a class="code" href="tabu__search_8h.html#437ef08681e7210d6678427030446a54">LEFT</a>)
<a name="l00082"></a>00082                         {
<a name="l00083"></a>00083                                 keys[i]=0x0;
<a name="l00084"></a>00084                                 keys[i]=key[1]^bits;
<a name="l00085"></a>00085                         }
<a name="l00086"></a>00086                         <span class="comment">/* movement for the right key block */</span>
<a name="l00087"></a>00087                         <span class="keywordflow">else</span>
<a name="l00088"></a>00088                         {
<a name="l00089"></a>00089                                 keys[i]=0x0;
<a name="l00090"></a>00090                                 keys[i]=key[3]^bits;
<a name="l00091"></a>00091                         }
<a name="l00092"></a>00092 
<a name="l00093"></a>00093                         scores[i]=<a class="code" href="tabu__search_8c.html#2567977f08461ce4a78dc7ac1d15f136">evaluate</a>(keys[i],cpmess,block,report,params);
<a name="l00094"></a>00094                 }
<a name="l00095"></a>00095                 <span class="keywordflow">if</span>(report-&gt;<a class="code" href="structoutput__report.html#67d9286ad83a76c54b74947442818b13">options</a>-&gt;<a class="code" href="structinput__opt.html#72693fd567f8d713a3abdf5843b8013e">paranoid_leve</a>&gt;1)
<a name="l00096"></a>00096                 {
<a name="l00097"></a>00097                         report-&gt;<a class="code" href="structoutput__report.html#082bbb7450420c6939c5c3ddef1d2127">par</a>-&gt;<a class="code" href="structparanoid__level.html#55fda2bb992bd5b9627e69828e7cfe8d">key</a>=keys[i];
<a name="l00098"></a>00098                         report-&gt;<a class="code" href="structoutput__report.html#082bbb7450420c6939c5c3ddef1d2127">par</a>-&gt;<a class="code" href="structparanoid__level.html#fb75c816010f96f9fa0d3cfb350b5e61">score</a>=scores[i];
<a name="l00099"></a>00099                         report-&gt;<a class="code" href="structoutput__report.html#082bbb7450420c6939c5c3ddef1d2127">par</a>-&gt;<a class="code" href="structparanoid__level.html#ed8a2a749d7ab713965d53085814c3d5">bit</a>=i;
<a name="l00100"></a>00100                         report-&gt;<a class="code" href="structoutput__report.html#082bbb7450420c6939c5c3ddef1d2127">par</a>-&gt;<a class="code" href="structparanoid__level.html#41c5e85c9fe94a6f83e91856de236198">block</a>=block;
<a name="l00101"></a>00101                         report-&gt;<a class="code" href="structoutput__report.html#082bbb7450420c6939c5c3ddef1d2127">par</a>-&gt;<a class="code" href="structparanoid__level.html#29707d1f0e746bf4015cc96f95a46904">tabu</a>=tabu;
<a name="l00102"></a>00102                         (report-&gt;<a class="code" href="structoutput__report.html#53540442ed3f872fec95b32e05066d84">print_paranoid_move</a>)(report-&gt;<a class="code" href="structoutput__report.html#082bbb7450420c6939c5c3ddef1d2127">par</a>,stderr);
<a name="l00103"></a>00103                 }
<a name="l00104"></a>00104                 tabu=<a class="code" href="types_8h.html#a93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00105"></a>00105                 bits=bits&lt;&lt; 1;
<a name="l00106"></a>00106         }
<a name="l00107"></a>00107         score=-<a class="code" href="tabu__search_8h.html#30a84777ef6bc779f7c1c5942575a5fc">POST_LIMIT</a>;
<a name="l00108"></a>00108         <span class="comment">/* find the best result for this movement */</span>
<a name="l00109"></a>00109         <span class="keywordflow">for</span>(i=0;i&lt;<a class="code" href="tabu__search_8h.html#de156992e10805c7e09be844b7780c79">TEA_DUAL_BLOCK</a>;i++)
<a name="l00110"></a>00110         {
<a name="l00111"></a>00111                         <span class="keywordflow">if</span>(scores[i]&gt;score&amp;&amp;scores[i]!=-<a class="code" href="tabu__search_8h.html#30a84777ef6bc779f7c1c5942575a5fc">POST_LIMIT</a>)
<a name="l00112"></a>00112                         {
<a name="l00113"></a>00113                                 position=i;
<a name="l00114"></a>00114                                 score=scores[position];
<a name="l00115"></a>00115                         }
<a name="l00116"></a>00116         }
<a name="l00117"></a>00117         <span class="comment">/* advance tabu list control */</span>
<a name="l00118"></a>00118         <span class="keywordflow">if</span>(*control==params-&gt;tabu_list_length)
<a name="l00119"></a>00119         {
<a name="l00120"></a>00120                 *control=1;
<a name="l00121"></a>00121         }
<a name="l00122"></a>00122         <span class="keywordflow">else</span>{
<a name="l00123"></a>00123                 *control+=1;
<a name="l00124"></a>00124         }
<a name="l00125"></a>00125         <span class="comment">/* add element move to tabu list */</span>
<a name="l00126"></a>00126         <span class="keywordflow">while</span>(1)
<a name="l00127"></a>00127         {
<a name="l00128"></a>00128                 <span class="keywordflow">if</span>(list-&gt;name==(*control-1))
<a name="l00129"></a>00129                 {
<a name="l00130"></a>00130                         list-&gt;key=keys[position];
<a name="l00131"></a>00131                         list-&gt;value=score;
<a name="l00132"></a>00132                         list-&gt;bit_position=position;
<a name="l00133"></a>00133                         <span class="keywordflow">break</span>;
<a name="l00134"></a>00134                 }
<a name="l00135"></a>00135                 <span class="keywordflow">else</span> list=list-&gt;next;
<a name="l00136"></a>00136         }
<a name="l00137"></a>00137         <span class="comment">/* check if this movement is better that the current best */</span>    
<a name="l00138"></a>00138         <span class="keywordflow">if</span>(score &gt; best-&gt;value)
<a name="l00139"></a>00139         {
<a name="l00140"></a>00140                 best-&gt;value=score;
<a name="l00141"></a>00141                 best-&gt;key[0]=0x0;
<a name="l00142"></a>00142                 best-&gt;key[1]=keys[position];
<a name="l00143"></a>00143                 best-&gt;bit=position;
<a name="l00144"></a>00144                 *mistakes=0;
<a name="l00145"></a>00145         }
<a name="l00146"></a>00146         <span class="keywordflow">else</span>
<a name="l00147"></a>00147         {
<a name="l00148"></a>00148                 <span class="comment">/* if not best, then increase mistakes counter */</span>
<a name="l00149"></a>00149                 *mistakes+=1;
<a name="l00150"></a>00150         }
<a name="l00151"></a>00151 
<a name="l00152"></a>00152         <span class="keywordflow">if</span>(block==<a class="code" href="tabu__search_8h.html#437ef08681e7210d6678427030446a54">LEFT</a>)
<a name="l00153"></a>00153         {
<a name="l00154"></a>00154                 key[0]=0x0;
<a name="l00155"></a>00155                 key[1]=keys[position];
<a name="l00156"></a>00156         }
<a name="l00157"></a>00157         <span class="keywordflow">else</span>
<a name="l00158"></a>00158         {
<a name="l00159"></a>00159                 key[2]=0x0;
<a name="l00160"></a>00160                 key[3]=keys[position];
<a name="l00161"></a>00161         }
<a name="l00162"></a>00162         (report-&gt;print_middle)(keys[position],score,position,block,list-&gt;name,stderr);
<a name="l00163"></a>00163 }
<a name="l00193"></a><a class="code" href="tabu__search_8h.html#63d127ef5866a6031375b89a547ab1ec">00193</a> <span class="keywordtype">void</span> <a class="code" href="tabu__search_8c.html#76650d01d07a956f2aa789c77a8a323d">move_beta</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *key,<a class="code" href="structtabu__list.html">tabu_list</a> *list,<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *mistakes,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *control,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *founded,<a class="code" href="structbest__result.html">best_result</a> *best,<a class="code" href="structtabu__search__params.html">ts_params</a> *params,<a class="code" href="structoutput__report.html">output_report</a> *report,<a class="code" href="structcontainer__node.html">cipher_cont</a> *cpmess,<span class="keywordtype">int</span> block)
<a name="l00194"></a>00194 {
<a name="l00195"></a>00195         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i,j;
<a name="l00196"></a>00196         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> bits=2;
<a name="l00197"></a>00197         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> keys[TEA_DUAL_BLOCK];
<a name="l00198"></a>00198         <span class="keywordtype">float</span> scores[TEA_DUAL_BLOCK];
<a name="l00199"></a>00199         <span class="keywordtype">float</span> score=0;
<a name="l00200"></a>00200         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> and_const=LONG_MAX;
<a name="l00201"></a>00201         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> tabu=<a class="code" href="types_8h.html#a93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00202"></a>00202         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> position=0;
<a name="l00203"></a>00203         
<a name="l00204"></a>00204         <span class="keywordflow">if</span>(*founded!=<a class="code" href="types_8h.html#a93f0eb578d23995850d61f7d61c55c1">FALSE</a>)
<a name="l00205"></a>00205         {
<a name="l00206"></a>00206                 <span class="keywordflow">return</span>;
<a name="l00207"></a>00207         }
<a name="l00208"></a>00208         <span class="keywordflow">for</span>(i=1;i&lt;TEA_DUAL_BLOCK;i++)
<a name="l00209"></a>00209         {
<a name="l00210"></a>00210                 scores[i]=-<a class="code" href="tabu__search_8h.html#30a84777ef6bc779f7c1c5942575a5fc">POST_LIMIT</a>;
<a name="l00211"></a>00211 
<a name="l00212"></a>00212                 <span class="keywordflow">for</span>(j=0;j&lt;params-&gt;<a class="code" href="structtabu__search__params.html#7f49d4ec523597ea9ddb839f80fbe2a8">tabu_list_length</a>;j++)
<a name="l00213"></a>00213                 {
<a name="l00214"></a>00214                         <span class="keywordflow">if</span>(list-&gt;<a class="code" href="structtabu__list.html#07a15f07895c76ee5acf99b3a1cb77be">bit_position</a>==i)
<a name="l00215"></a>00215                         {
<a name="l00216"></a>00216                                 tabu=<a class="code" href="types_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00217"></a>00217                                 <span class="keywordflow">break</span>;
<a name="l00218"></a>00218                         }
<a name="l00219"></a>00219                         list=list-&gt;<a class="code" href="structtabu__list.html#0e67af91d43756f1e998bd52351220df">next</a>;
<a name="l00220"></a>00220                 }
<a name="l00221"></a>00221                 <span class="keywordflow">if</span>(tabu==<a class="code" href="types_8h.html#a93f0eb578d23995850d61f7d61c55c1">FALSE</a>)
<a name="l00222"></a>00222                 {
<a name="l00223"></a>00223                         <span class="comment">/* movement for the left key block */</span>
<a name="l00224"></a>00224                         <span class="keywordflow">if</span>(block==<a class="code" href="tabu__search_8h.html#437ef08681e7210d6678427030446a54">LEFT</a>)
<a name="l00225"></a>00225                         {
<a name="l00226"></a>00226                                 keys[i]=0x0;
<a name="l00227"></a>00227                                 <span class="keywordflow">if</span>(!((key[1]&amp;bits)&amp;&amp;(key[1]&amp;bits&gt;&gt;1))&amp;&amp;!(((key[1]^and_const)&amp;bits)&amp;&amp;((key[1]^and_const)&amp;bits&gt;&gt;1)))
<a name="l00228"></a>00228                                 {
<a name="l00229"></a>00229                                         keys[i]=key[1]^bits;
<a name="l00230"></a>00230                                         keys[i]=keys[i]^bits&gt;&gt;1;
<a name="l00231"></a>00231                                 }
<a name="l00232"></a>00232                                 <span class="keywordflow">else</span> keys[i]=key[1];
<a name="l00233"></a>00233                         }
<a name="l00234"></a>00234                         <span class="comment">/* movement for the right key block */</span>
<a name="l00235"></a>00235                         <span class="keywordflow">else</span>{
<a name="l00236"></a>00236                                 keys[i]=0x0;
<a name="l00237"></a>00237                                 
<a name="l00238"></a>00238                                 <span class="keywordflow">if</span>(!((key[3]&amp;bits)&amp;&amp;(key[3]&amp;bits&gt;&gt;1))&amp;&amp;!(((key[3]^and_const)&amp;bits)&amp;&amp;((key[3]^and_const)&amp;bits&gt;&gt;1)))
<a name="l00239"></a>00239                                 {
<a name="l00240"></a>00240                                         keys[i]=key[3]^bits;
<a name="l00241"></a>00241                                         keys[i]=keys[i]^bits&gt;&gt;1;
<a name="l00242"></a>00242                                 }
<a name="l00243"></a>00243                                 <span class="keywordflow">else</span> keys[i]=key[3];
<a name="l00244"></a>00244                         }
<a name="l00245"></a>00245                         scores[i]=<a class="code" href="tabu__search_8c.html#2567977f08461ce4a78dc7ac1d15f136">evaluate</a>(keys[i],cpmess,block,report,params);
<a name="l00246"></a>00246                 }
<a name="l00247"></a>00247                 <span class="keywordflow">if</span>(report-&gt;<a class="code" href="structoutput__report.html#67d9286ad83a76c54b74947442818b13">options</a>-&gt;<a class="code" href="structinput__opt.html#72693fd567f8d713a3abdf5843b8013e">paranoid_leve</a>&gt;1)
<a name="l00248"></a>00248                 {
<a name="l00249"></a>00249                         report-&gt;<a class="code" href="structoutput__report.html#082bbb7450420c6939c5c3ddef1d2127">par</a>-&gt;<a class="code" href="structparanoid__level.html#55fda2bb992bd5b9627e69828e7cfe8d">key</a>=keys[i];
<a name="l00250"></a>00250                         report-&gt;<a class="code" href="structoutput__report.html#082bbb7450420c6939c5c3ddef1d2127">par</a>-&gt;<a class="code" href="structparanoid__level.html#fb75c816010f96f9fa0d3cfb350b5e61">score</a>=scores[i];
<a name="l00251"></a>00251                         report-&gt;<a class="code" href="structoutput__report.html#082bbb7450420c6939c5c3ddef1d2127">par</a>-&gt;<a class="code" href="structparanoid__level.html#ed8a2a749d7ab713965d53085814c3d5">bit</a>=i;
<a name="l00252"></a>00252                         report-&gt;<a class="code" href="structoutput__report.html#082bbb7450420c6939c5c3ddef1d2127">par</a>-&gt;<a class="code" href="structparanoid__level.html#41c5e85c9fe94a6f83e91856de236198">block</a>=block;
<a name="l00253"></a>00253                         report-&gt;<a class="code" href="structoutput__report.html#082bbb7450420c6939c5c3ddef1d2127">par</a>-&gt;<a class="code" href="structparanoid__level.html#29707d1f0e746bf4015cc96f95a46904">tabu</a>=tabu;
<a name="l00254"></a>00254                         (report-&gt;<a class="code" href="structoutput__report.html#53540442ed3f872fec95b32e05066d84">print_paranoid_move</a>)(report-&gt;<a class="code" href="structoutput__report.html#082bbb7450420c6939c5c3ddef1d2127">par</a>,stderr);
<a name="l00255"></a>00255                 }
<a name="l00256"></a>00256                 tabu=<a class="code" href="types_8h.html#a93f0eb578d23995850d61f7d61c55c1">FALSE</a>;
<a name="l00257"></a>00257                 bits=bits &lt;&lt; 1;
<a name="l00258"></a>00258         }
<a name="l00259"></a>00259         score=-<a class="code" href="tabu__search_8h.html#30a84777ef6bc779f7c1c5942575a5fc">POST_LIMIT</a>;
<a name="l00260"></a>00260 
<a name="l00261"></a>00261         <span class="keywordflow">for</span>(i=0;i&lt;TEA_DUAL_BLOCK;i++)
<a name="l00262"></a>00262         {
<a name="l00263"></a>00263                 <span class="keywordflow">if</span>(scores[i]&gt;score&amp;&amp;scores[i]!=-<a class="code" href="tabu__search_8h.html#30a84777ef6bc779f7c1c5942575a5fc">POST_LIMIT</a>)
<a name="l00264"></a>00264                 {
<a name="l00265"></a>00265                         position=i;
<a name="l00266"></a>00266                         score=scores[position];
<a name="l00267"></a>00267                 }
<a name="l00268"></a>00268         }
<a name="l00269"></a>00269         <span class="keywordflow">if</span>(*control==params-&gt;tabu_list_length)
<a name="l00270"></a>00270         {
<a name="l00271"></a>00271                 *control=1;
<a name="l00272"></a>00272         }
<a name="l00273"></a>00273         <span class="keywordflow">else</span>
<a name="l00274"></a>00274         {
<a name="l00275"></a>00275                 *control+=1;
<a name="l00276"></a>00276         }
<a name="l00277"></a>00277         <span class="keywordflow">while</span>(1)
<a name="l00278"></a>00278         {
<a name="l00279"></a>00279                 <span class="keywordflow">if</span>(list-&gt;name==(*control-1))
<a name="l00280"></a>00280                 {
<a name="l00281"></a>00281                         list-&gt;key=keys[position];
<a name="l00282"></a>00282                         list-&gt;value=score;
<a name="l00283"></a>00283                         list-&gt;bit_position=position;
<a name="l00284"></a>00284                         <span class="keywordflow">break</span>;
<a name="l00285"></a>00285                 }
<a name="l00286"></a>00286                 <span class="keywordflow">else</span> list=list-&gt;next;
<a name="l00287"></a>00287         }
<a name="l00288"></a>00288         <span class="keywordflow">if</span>(score &gt; best-&gt;value)
<a name="l00289"></a>00289         {
<a name="l00290"></a>00290                 best-&gt;value=score;
<a name="l00291"></a>00291                 best-&gt;key[0]=0x0;
<a name="l00292"></a>00292                 best-&gt;key[1]=keys[position];
<a name="l00293"></a>00293                 best-&gt;bit=position;
<a name="l00294"></a>00294                 *mistakes=0;
<a name="l00295"></a>00295         }
<a name="l00296"></a>00296         <span class="keywordflow">else</span>{
<a name="l00297"></a>00297                 *mistakes+=1;
<a name="l00298"></a>00298         }
<a name="l00299"></a>00299         <span class="keywordflow">if</span>(block==<a class="code" href="tabu__search_8h.html#437ef08681e7210d6678427030446a54">LEFT</a>)
<a name="l00300"></a>00300         {
<a name="l00301"></a>00301                 key[0]=0x0;
<a name="l00302"></a>00302                 key[1]=keys[position];
<a name="l00303"></a>00303         }
<a name="l00304"></a>00304         <span class="keywordflow">else</span>
<a name="l00305"></a>00305         {
<a name="l00306"></a>00306                 key[2]=0x0;
<a name="l00307"></a>00307                 key[3]=keys[position];
<a name="l00308"></a>00308         }
<a name="l00309"></a>00309         (report-&gt;print_middle)(keys[position],score,position,block,list-&gt;name,stderr);
<a name="l00310"></a>00310 }
<a name="l00340"></a><a class="code" href="tabu__search_8h.html#6bfde975281346ebcc68c7d796554f8c">00340</a> <span class="keywordtype">float</span> <a class="code" href="tabu__search_8c.html#2567977f08461ce4a78dc7ac1d15f136">evaluate</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> key,<a class="code" href="structcontainer__node.html">cipher_cont</a> *cpmess,<span class="keywordtype">int</span> block,<a class="code" href="structoutput__report.html">output_report</a> *report,<a class="code" href="structtabu__search__params.html">ts_params</a> *params)
<a name="l00341"></a>00341 {
<a name="l00342"></a>00342         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> composed_key[4]={0x0,0x0,0x0,0x0}; <span class="comment">/*&lt; key composed with key part to generate new key blocks */</span>
<a name="l00343"></a>00343         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i,j;
<a name="l00344"></a>00344         <span class="keywordtype">int</span> value_ones=0;                                <span class="comment">/*&lt; number of zeros */</span>
<a name="l00345"></a>00345         <span class="keywordtype">int</span> value_zeros=0;                               <span class="comment">/*&lt; numer of ones */</span>
<a name="l00346"></a>00346         <span class="keywordtype">int</span> percent_value=0;                             <span class="comment">/*&lt; accuracy percent for evaluation */</span>
<a name="l00347"></a>00347         <span class="keywordtype">float</span> value=0;                                   <span class="comment">/*&lt; final evaluation value */</span>
<a name="l00348"></a>00348         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> bits=1;                            <span class="comment">/*&lt; bits to move */</span>
<a name="l00349"></a>00349         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *key_compare;                      <span class="comment">/*&lt; store new generated key*/</span>
<a name="l00350"></a>00350         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> and_const=LONG_MAX;                <span class="comment">/*&lt; 32 bits of ones */</span>
<a name="l00351"></a>00351         
<a name="l00352"></a>00352         <span class="keywordflow">if</span>((key_compare=<a class="code" href="types_8h.html#008af604b10fb58647bde35dd155ef8b">NMALLOC</a>(cpmess[0].size_array,<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>))==NULL)
<a name="l00353"></a>00353         {
<a name="l00354"></a>00354                 fprintf(stderr,<span class="stringliteral">"ERROR: FAILED TO ALLOCATE MEMORY\n"</span>);
<a name="l00355"></a>00355                 exit(1);
<a name="l00356"></a>00356         }
<a name="l00357"></a>00357         
<a name="l00358"></a>00358         <span class="keywordflow">if</span>(block==<a class="code" href="tabu__search_8h.html#437ef08681e7210d6678427030446a54">LEFT</a>)
<a name="l00359"></a>00359         {
<a name="l00360"></a>00360                 composed_key[1]=key;
<a name="l00361"></a>00361         }
<a name="l00362"></a>00362         <span class="keywordflow">else</span>
<a name="l00363"></a>00363         {
<a name="l00364"></a>00364                 composed_key[3]=key;
<a name="l00365"></a>00365         }
<a name="l00366"></a>00366         
<a name="l00367"></a>00367         <span class="keywordflow">if</span>(report-&gt;<a class="code" href="structoutput__report.html#67d9286ad83a76c54b74947442818b13">options</a>-&gt;<a class="code" href="structinput__opt.html#72693fd567f8d713a3abdf5843b8013e">paranoid_leve</a>&gt;2)
<a name="l00368"></a>00368         {
<a name="l00369"></a>00369                 <span class="keywordflow">if</span>((report-&gt;<a class="code" href="structoutput__report.html#3c7b3487ac842690a2eaaa00e12a2121">pardeb</a>=<a class="code" href="types_8h.html#137ef1902042f87f3eba5d1c3b2a0638">MALLOC</a>(<a class="code" href="structparanoid__level.html">paranoid</a>))==NULL)
<a name="l00370"></a>00370                 {
<a name="l00371"></a>00371                         fprintf(stderr,<span class="stringliteral">"ERROR: FAILED TO ALLOCATE MEMORY\n"</span>);
<a name="l00372"></a>00372                         exit(1);
<a name="l00373"></a>00373                 }
<a name="l00374"></a>00374         }
<a name="l00375"></a>00375         
<a name="l00376"></a>00376         <span class="keywordflow">for</span>(i=0;i&lt;(cpmess[0].<a class="code" href="structcontainer__node.html#e57605504b39d19bcaaccdf3605608f7">size_array</a>);i++)
<a name="l00377"></a>00377         {
<a name="l00378"></a>00378                 <span class="keywordflow">if</span>(block==<a class="code" href="tabu__search_8h.html#437ef08681e7210d6678427030446a54">LEFT</a>)
<a name="l00379"></a>00379                 {
<a name="l00380"></a>00380                         <a class="code" href="tea_8c.html#807528dd32c2845934d7ceca16d31728">gamma_tea</a>(cpmess[i].plain_message,cpmess[i].cipher_message,composed_key);
<a name="l00381"></a>00381                         key_compare[i]=composed_key[0];
<a name="l00382"></a>00382                 }
<a name="l00383"></a>00383                 <span class="keywordflow">else</span>
<a name="l00384"></a>00384                 {
<a name="l00385"></a>00385                         <a class="code" href="tea_8c.html#6d383edb519fb59fe865b83d25512ae9">delta_tea</a>(cpmess[i].plain_message,cpmess[i].cipher_message,composed_key);
<a name="l00386"></a>00386                         key_compare[i]=composed_key[2];
<a name="l00387"></a>00387                 }
<a name="l00388"></a>00388                 <span class="keywordflow">if</span>(report-&gt;<a class="code" href="structoutput__report.html#67d9286ad83a76c54b74947442818b13">options</a>-&gt;<a class="code" href="structinput__opt.html#72693fd567f8d713a3abdf5843b8013e">paranoid_leve</a>&gt;3)
<a name="l00389"></a>00389                 {
<a name="l00390"></a>00390                         report-&gt;<a class="code" href="structoutput__report.html#3c7b3487ac842690a2eaaa00e12a2121">pardeb</a>-&gt;<a class="code" href="structparanoid__level.html#55fda2bb992bd5b9627e69828e7cfe8d">key</a>=key;
<a name="l00391"></a>00391                         report-&gt;<a class="code" href="structoutput__report.html#3c7b3487ac842690a2eaaa00e12a2121">pardeb</a>-&gt;<a class="code" href="structparanoid__level.html#ed8a2a749d7ab713965d53085814c3d5">bit</a>=i;
<a name="l00392"></a>00392                         report-&gt;<a class="code" href="structoutput__report.html#3c7b3487ac842690a2eaaa00e12a2121">pardeb</a>-&gt;<a class="code" href="structparanoid__level.html#41c5e85c9fe94a6f83e91856de236198">block</a>=block;
<a name="l00393"></a>00393                         report-&gt;<a class="code" href="structoutput__report.html#3c7b3487ac842690a2eaaa00e12a2121">pardeb</a>-&gt;<a class="code" href="structparanoid__level.html#003bbf46441ac693f234892d3790d751">evalkey</a>=key_compare[i];
<a name="l00394"></a>00394                 }
<a name="l00395"></a>00395                 (report-&gt;<a class="code" href="structoutput__report.html#f51a649c75904fe583881bd38791d8be">print_paranoid_all</a>)(report-&gt;<a class="code" href="structoutput__report.html#3c7b3487ac842690a2eaaa00e12a2121">pardeb</a>,stderr);
<a name="l00396"></a>00396         }
<a name="l00397"></a>00397         <span class="comment">/* our key compare percent */</span>
<a name="l00398"></a>00398         percent_value=(int)((params-&gt;<a class="code" href="structtabu__search__params.html#4e6ab6880e04d25417ef1f04afc55bc5">key_eval_percent</a>)*cpmess[0].<a class="code" href="structcontainer__node.html#e57605504b39d19bcaaccdf3605608f7">size_array</a>);
<a name="l00399"></a>00399         
<a name="l00400"></a>00400         <span class="keywordflow">if</span>(report-&gt;<a class="code" href="structoutput__report.html#67d9286ad83a76c54b74947442818b13">options</a>-&gt;<a class="code" href="structinput__opt.html#72693fd567f8d713a3abdf5843b8013e">paranoid_leve</a>&gt;2)
<a name="l00401"></a>00401         {
<a name="l00402"></a>00402                 report-&gt;<a class="code" href="structoutput__report.html#3c7b3487ac842690a2eaaa00e12a2121">pardeb</a>-&gt;<a class="code" href="structparanoid__level.html#fe31ab21f4b91869e4150057d94eda73">percent</a>=percent_value;
<a name="l00403"></a>00403         }
<a name="l00404"></a>00404         <span class="keywordflow">for</span>(i=0;i&lt;TEA_DUAL_BLOCK;i++)
<a name="l00405"></a>00405         {
<a name="l00406"></a>00406                 value_zeros=0;
<a name="l00407"></a>00407                 value_ones=0;
<a name="l00408"></a>00408                 <span class="keywordflow">for</span>(j=0;j&lt;(cpmess[0].<a class="code" href="structcontainer__node.html#e57605504b39d19bcaaccdf3605608f7">size_array</a>);j++)
<a name="l00409"></a>00409                 {
<a name="l00410"></a>00410                         <span class="comment">/* if the ith bit is one */</span>
<a name="l00411"></a>00411                         <span class="keywordflow">if</span>((key_compare[j]&amp;bits)!=0)
<a name="l00412"></a>00412                         {
<a name="l00413"></a>00413                                 value_ones++;
<a name="l00414"></a>00414                         }
<a name="l00415"></a>00415                         <span class="keywordflow">else</span>{
<a name="l00416"></a>00416                                 <span class="comment">/* if the ith bit is zero */</span>
<a name="l00417"></a>00417                                 <span class="keywordflow">if</span>(((key_compare[j]^and_const)&amp;bits)!=0)
<a name="l00418"></a>00418                                 {
<a name="l00419"></a>00419                                         value_zeros++;
<a name="l00420"></a>00420                                 }
<a name="l00421"></a>00421                         }                       
<a name="l00422"></a>00422                 }
<a name="l00423"></a>00423                 bits=bits&lt;&lt;1;
<a name="l00424"></a>00424                 <span class="keywordflow">if</span>(report-&gt;<a class="code" href="structoutput__report.html#67d9286ad83a76c54b74947442818b13">options</a>-&gt;<a class="code" href="structinput__opt.html#72693fd567f8d713a3abdf5843b8013e">paranoid_leve</a>&gt;2)
<a name="l00425"></a>00425                 {
<a name="l00426"></a>00426                         report-&gt;<a class="code" href="structoutput__report.html#3c7b3487ac842690a2eaaa00e12a2121">pardeb</a>-&gt;<a class="code" href="structparanoid__level.html#ed8a2a749d7ab713965d53085814c3d5">bit</a>=j;
<a name="l00427"></a>00427                         report-&gt;<a class="code" href="structoutput__report.html#3c7b3487ac842690a2eaaa00e12a2121">pardeb</a>-&gt;<a class="code" href="structparanoid__level.html#f030c03e7dd0fffe8baa34ae18a3301b">zeros</a>=value_zeros;
<a name="l00428"></a>00428                         report-&gt;<a class="code" href="structoutput__report.html#3c7b3487ac842690a2eaaa00e12a2121">pardeb</a>-&gt;<a class="code" href="structparanoid__level.html#69d7220fc6049266fbaa018da3de85ff">ones</a>=value_ones;
<a name="l00429"></a>00429                         report-&gt;<a class="code" href="structoutput__report.html#3c7b3487ac842690a2eaaa00e12a2121">pardeb</a>-&gt;<a class="code" href="structparanoid__level.html#4448b8f0a5e6df597356ac69b8a1df9a">element</a>=i;
<a name="l00430"></a>00430                 }
<a name="l00431"></a>00431                 (report-&gt;<a class="code" href="structoutput__report.html#ef1692be149a98795c2112d2b5f97f24">print_paranoid_eval</a>)(report-&gt;<a class="code" href="structoutput__report.html#3c7b3487ac842690a2eaaa00e12a2121">pardeb</a>,stderr);
<a name="l00432"></a>00432                 <span class="comment">/*</span>
<a name="l00433"></a>00433 <span class="comment">                 * if the amount of mirror bits it superior that the percent number of bits, then accept the mirror, otherwise</span>
<a name="l00434"></a>00434 <span class="comment">                 * return with worst value.</span>
<a name="l00435"></a>00435 <span class="comment">                 */</span>
<a name="l00436"></a>00436                 <span class="keywordflow">if</span>(value_ones&gt;percent_value||value_zeros&gt;percent_value)
<a name="l00437"></a>00437                 {
<a name="l00438"></a>00438                         value++;
<a name="l00439"></a>00439                 }
<a name="l00440"></a>00440                 <span class="keywordflow">else</span>{
<a name="l00441"></a>00441                         <span class="keywordflow">break</span>;
<a name="l00442"></a>00442                 }
<a name="l00443"></a>00443         }
<a name="l00444"></a>00444         <span class="keywordflow">if</span>(report-&gt;options-&gt;paranoid_leve&gt;2)
<a name="l00445"></a>00445         {
<a name="l00446"></a>00446                 free((<span class="keywordtype">char</span> *)report-&gt;pardeb);
<a name="l00447"></a>00447         }
<a name="l00448"></a>00448         free((<span class="keywordtype">char</span> *)key_compare);
<a name="l00449"></a>00449         <span class="keywordflow">return</span>(value);
<a name="l00450"></a>00450 }
<a name="l00457"></a><a class="code" href="tabu__search_8h.html#71ef4c9636a49646d17aad7ddf725c20">00457</a> <span class="keywordtype">void</span> <a class="code" href="tabu__search_8c.html#3a881cc57c87c0627403e0ae7e902eed">tabusearch</a>(<a class="code" href="structcontainer__node.html">cipher_cont</a> *cpmess,<a class="code" href="structinput__opt.html">input_options</a> *options,<a class="code" href="structoutput__report.html">output_report</a> *report)
<a name="l00458"></a>00458 {
<a name="l00459"></a>00459         
<a name="l00460"></a>00460         
<a name="l00461"></a>00461         <a class="code" href="structbest__result.html">best_result</a> *best_left;                                  <span class="comment">/*&lt; best result container for left key block */</span>
<a name="l00462"></a>00462         <a class="code" href="structbest__result.html">best_result</a> *best_right;                         <span class="comment">/*&lt; best result container for right key block */</span>
<a name="l00463"></a>00463         <a class="code" href="structtabu__search__params.html">ts_params</a> *params;                               <span class="comment">/*&lt; params for tabu search movement and other criteria */</span> 
<a name="l00464"></a>00464         <a class="code" href="structtabu__list.html">tabu_list</a> *list_left;                                    <span class="comment">/*&lt; tabu list for left key block */</span>
<a name="l00465"></a>00465         <a class="code" href="structtabu__list.html">tabu_list</a> *list_right;                                   <span class="comment">/*&lt; tabu list for right key block */</span>
<a name="l00466"></a>00466         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> key[4];                                    <span class="comment">/*&lt; a 128 bits key*/</span>
<a name="l00467"></a>00467         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> mistakes_left=0;                   <span class="comment">/*&lt; how many mistakes are in the left serach */</span>
<a name="l00468"></a>00468         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> mistakes_right=0;                  <span class="comment">/*&lt; how many mistakes are in the right serach */</span>
<a name="l00469"></a>00469         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> control_left=0;                     <span class="comment">/*&lt; which is the current modified element in the left list */</span>
<a name="l00470"></a>00470         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> control_right=0;                    <span class="comment">/*&lt; which is the current modified element in the right list */</span>
<a name="l00471"></a>00471         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> founded_left=<a class="code" href="types_8h.html#a93f0eb578d23995850d61f7d61c55c1">FALSE</a>;                 <span class="comment">/*&lt; if the left key has been founded */</span>
<a name="l00472"></a>00472         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> founded_right=<a class="code" href="types_8h.html#a93f0eb578d23995850d61f7d61c55c1">FALSE</a>;                <span class="comment">/*&lt; if the right key has been founded */</span>
<a name="l00473"></a>00473         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> restart_left_control=0;     <span class="comment">/*&lt; restart count for left key block */</span>
<a name="l00474"></a>00474         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> restart_right_control=0;    <span class="comment">/*&lt; restart counter for right key block */</span>
<a name="l00475"></a>00475         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> restart_left_mv_control=0;  <span class="comment">/*&lt; restart count for left key block */</span>
<a name="l00476"></a>00476         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> restart_right_mv_control=0; <span class="comment">/*&lt; restart counter for right key block */</span>
<a name="l00477"></a>00477         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> change_left_count=0;        <span class="comment">/*&lt; movement change counter for left key block */</span>
<a name="l00478"></a>00478         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> change_right_count=0;       <span class="comment">/*&lt; movement change counter for right key block */</span>
<a name="l00479"></a>00479         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> left_iter=0;                <span class="comment">/*&lt; left iteration number */</span>
<a name="l00480"></a>00480         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> right_iter=0;               <span class="comment">/*&lt; right iteration number */</span>
<a name="l00481"></a>00481         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;                                                <span class="comment">/*&lt; just a counter */</span>
<a name="l00482"></a>00482         <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> bit=1;
<a name="l00483"></a>00483         <a class="code" href="structtabu__movement.html">movement</a> *move_left;                                     <span class="comment">/*&lt; movement for left key block */</span>
<a name="l00484"></a>00484         <a class="code" href="structtabu__movement.html">movement</a> *move_right;                                    <span class="comment">/*&lt; movement for right key block */</span>
<a name="l00485"></a>00485         <a class="code" href="structfinal__report.html">final_report</a> *report_final;                      <span class="comment">/*&lt; structure for final report generation */</span>
<a name="l00486"></a>00486         time_t init_right_seconds;               
<a name="l00487"></a>00487         time_t end_right_seconds;
<a name="l00488"></a>00488         time_t init_left_seconds;
<a name="l00489"></a>00489         time_t end_left_seconds;
<a name="l00490"></a>00490         time_t init_global_seconds;
<a name="l00491"></a>00491         time_t end_global_seconds;
<a name="l00492"></a>00492         clock_t global_clock;                                    <span class="comment">/*&lt; clock count for global tabu search */</span>
<a name="l00493"></a>00493         clock_t right_clock;                                     <span class="comment">/*&lt; clock count for right tabu search */</span>
<a name="l00494"></a>00494         clock_t left_clock;                                      <span class="comment">/*&lt; clock count for left tabu search */</span>
<a name="l00495"></a>00495         
<a name="l00496"></a>00496         time(&amp;init_global_seconds);
<a name="l00497"></a>00497         
<a name="l00498"></a>00498         <span class="keywordflow">if</span>((move_left=<a class="code" href="types_8h.html#137ef1902042f87f3eba5d1c3b2a0638">MALLOC</a>(<a class="code" href="structtabu__movement.html">movement</a>))==NULL)
<a name="l00499"></a>00499         {
<a name="l00500"></a>00500                 fprintf(stderr,<span class="stringliteral">"ERROR: FAILED TO ALLOCATE MEMORY\n"</span>);
<a name="l00501"></a>00501                 exit(1);
<a name="l00502"></a>00502         }
<a name="l00503"></a>00503         <span class="keywordflow">if</span>((move_right=<a class="code" href="types_8h.html#137ef1902042f87f3eba5d1c3b2a0638">MALLOC</a>(<a class="code" href="structtabu__movement.html">movement</a>))==NULL)
<a name="l00504"></a>00504         {
<a name="l00505"></a>00505                 fprintf(stderr,<span class="stringliteral">"ERROR: FAILED TO ALLOCATE MEMORY\n"</span>);
<a name="l00506"></a>00506                 exit(1);
<a name="l00507"></a>00507         }
<a name="l00508"></a>00508         
<a name="l00509"></a>00509         <span class="comment">/* initialize movements */</span>
<a name="l00510"></a>00510         move_left-&gt;<a class="code" href="structtabu__movement.html#d2ab26b6f7904a7f8e8cce8642e8e9d1">move</a>=(<span class="keywordtype">void</span> *)&amp;<a class="code" href="tabu__search_8c.html#6923e47c8f97b184b285c378c83a2a81">move_alpha</a>;
<a name="l00511"></a>00511         move_right-&gt;<a class="code" href="structtabu__movement.html#d2ab26b6f7904a7f8e8cce8642e8e9d1">move</a>=(<span class="keywordtype">void</span> *)&amp;<a class="code" href="tabu__search_8c.html#6923e47c8f97b184b285c378c83a2a81">move_alpha</a>;
<a name="l00512"></a>00512         
<a name="l00513"></a>00513         <span class="comment">/* generate a initial random solucion for the problem */</span>
<a name="l00514"></a>00514         <a class="code" href="tabu__search_8c.html#6527a198a1e034d0278b98165288abf8">generate_initial_solution</a>(key);
<a name="l00515"></a>00515 
<a name="l00516"></a>00516         <span class="comment">/* generate tabu search parameters */</span>
<a name="l00517"></a>00517         params=<a class="code" href="tabu__search_8c.html#f4f7d6f12872c48af20f26b03f578217">create_params</a>(options);
<a name="l00518"></a>00518 
<a name="l00519"></a>00519         <span class="comment">/* generate tabu list for 2 key blocks*/</span>
<a name="l00520"></a>00520         list_left=<a class="code" href="tabu__search_8c.html#ca35ea71a4b06484496f426aae819406">create_tabu_list</a>(params);
<a name="l00521"></a>00521         list_right=<a class="code" href="tabu__search_8c.html#ca35ea71a4b06484496f426aae819406">create_tabu_list</a>(params);
<a name="l00522"></a>00522         
<a name="l00523"></a>00523         <span class="comment">/* activate best result data structure for 2 key blocks */</span>
<a name="l00524"></a>00524         <span class="keywordflow">if</span>(!((best_left=<a class="code" href="types_8h.html#137ef1902042f87f3eba5d1c3b2a0638">MALLOC</a>(<a class="code" href="structbest__result.html">best_result</a>))==NULL))
<a name="l00525"></a>00525         {
<a name="l00526"></a>00526                 best_left-&gt;<a class="code" href="structbest__result.html#ab2b928ff847997f138d79954f51466a">key</a>[0]=key[0];
<a name="l00527"></a>00527                 best_left-&gt;<a class="code" href="structbest__result.html#ab2b928ff847997f138d79954f51466a">key</a>[1]=key[1];
<a name="l00528"></a>00528                 best_left-&gt;<a class="code" href="structbest__result.html#91ca983f99d5b7d1d8ee264a597294c6">bit</a>=0;
<a name="l00529"></a>00529                 best_left-&gt;<a class="code" href="structbest__result.html#a6445e58e2f3bcf7e5a8dbe4e9fe3973">value</a>=<a class="code" href="tabu__search_8c.html#2567977f08461ce4a78dc7ac1d15f136">evaluate</a>(key[1],cpmess,<a class="code" href="tabu__search_8h.html#437ef08681e7210d6678427030446a54">LEFT</a>,report,params);
<a name="l00530"></a>00530         }
<a name="l00531"></a>00531         <span class="keywordflow">else</span>
<a name="l00532"></a>00532         {
<a name="l00533"></a>00533                 fprintf(stderr,<span class="stringliteral">"ERROR: FAILED TO ALLOCATE MEMORY\n"</span>);
<a name="l00534"></a>00534                 exit(1);
<a name="l00535"></a>00535         }
<a name="l00536"></a>00536         <span class="keywordflow">if</span>(!((best_right=<a class="code" href="types_8h.html#137ef1902042f87f3eba5d1c3b2a0638">MALLOC</a>(<a class="code" href="structbest__result.html">best_result</a>))==NULL))
<a name="l00537"></a>00537         {
<a name="l00538"></a>00538                 best_right-&gt;<a class="code" href="structbest__result.html#ab2b928ff847997f138d79954f51466a">key</a>[0]=key[2];
<a name="l00539"></a>00539                 best_right-&gt;<a class="code" href="structbest__result.html#ab2b928ff847997f138d79954f51466a">key</a>[1]=key[3];
<a name="l00540"></a>00540                 best_right-&gt;<a class="code" href="structbest__result.html#91ca983f99d5b7d1d8ee264a597294c6">bit</a>=0;
<a name="l00541"></a>00541                 best_right-&gt;<a class="code" href="structbest__result.html#a6445e58e2f3bcf7e5a8dbe4e9fe3973">value</a>=<a class="code" href="tabu__search_8c.html#2567977f08461ce4a78dc7ac1d15f136">evaluate</a>(key[3],cpmess,<a class="code" href="tabu__search_8h.html#80fb826a684cf3f0d306b22aa100ddac">RIGHT</a>,report,params);
<a name="l00542"></a>00542         }
<a name="l00543"></a>00543         <span class="keywordflow">else</span>
<a name="l00544"></a>00544         {
<a name="l00545"></a>00545                 fprintf(stderr,<span class="stringliteral">"ERROR: FAILED TO ALLOCATE MEMORY\n"</span>);
<a name="l00546"></a>00546                 exit(1);
<a name="l00547"></a>00547         }
<a name="l00548"></a>00548         
<a name="l00549"></a>00549         (report-&gt;<a class="code" href="structoutput__report.html#a4df0a122853fef1ceda0f7c3ebfe8d7">print_init</a>)(params,report-&gt;<a class="code" href="structoutput__report.html#67d9286ad83a76c54b74947442818b13">options</a>,stdout);
<a name="l00550"></a>00550         <span class="keywordflow">if</span>(report-&gt;<a class="code" href="structoutput__report.html#67d9286ad83a76c54b74947442818b13">options</a>-&gt;<a class="code" href="structinput__opt.html#5d58566752141a1a2738a32c5df18bc3">save_output</a>)
<a name="l00551"></a>00551         {
<a name="l00552"></a>00552                 (report-&gt;<a class="code" href="structoutput__report.html#a4df0a122853fef1ceda0f7c3ebfe8d7">print_init</a>)(params,report-&gt;<a class="code" href="structoutput__report.html#67d9286ad83a76c54b74947442818b13">options</a>,report-&gt;<a class="code" href="structoutput__report.html#15246ebf2baca00e1a8a4959ca5a39b6">report_file</a>);
<a name="l00553"></a>00553         }
<a name="l00554"></a>00554         
<a name="l00555"></a>00555         time(&amp;init_left_seconds);
<a name="l00556"></a>00556         time(&amp;init_right_seconds);
<a name="l00557"></a>00557         
<a name="l00558"></a>00558         <span class="keywordflow">if</span>(report-&gt;<a class="code" href="structoutput__report.html#67d9286ad83a76c54b74947442818b13">options</a>-&gt;<a class="code" href="structinput__opt.html#72693fd567f8d713a3abdf5843b8013e">paranoid_leve</a>&gt;0)
<a name="l00559"></a>00559         {
<a name="l00560"></a>00560                 <span class="keywordflow">if</span>((report-&gt;<a class="code" href="structoutput__report.html#082bbb7450420c6939c5c3ddef1d2127">par</a>=<a class="code" href="types_8h.html#137ef1902042f87f3eba5d1c3b2a0638">MALLOC</a>(<a class="code" href="structparanoid__level.html">paranoid</a>))==NULL)
<a name="l00561"></a>00561                 {
<a name="l00562"></a>00562                         fprintf(stderr,<span class="stringliteral">"ERROR: FAILED TO ALLOCATE MEMORY\n"</span>);
<a name="l00563"></a>00563                         exit(1);
<a name="l00564"></a>00564                 }
<a name="l00565"></a>00565         }
<a name="l00566"></a>00566 
<a name="l00567"></a>00567         
<a name="l00568"></a>00568         <span class="keywordflow">for</span>(i=0;i&lt;params-&gt;<a class="code" href="structtabu__search__params.html#963570c3e1373876501280de48cdc069">tabu_iterations</a>;i++)
<a name="l00569"></a>00569         {
<a name="l00570"></a>00570                 <span class="keywordflow">if</span>(founded_left==<a class="code" href="types_8h.html#a93f0eb578d23995850d61f7d61c55c1">FALSE</a>)
<a name="l00571"></a>00571                 {
<a name="l00572"></a>00572                         <span class="comment">/*</span>
<a name="l00573"></a>00573 <span class="comment">                         * Individual movement selection for left key block </span>
<a name="l00574"></a>00574 <span class="comment">                         */</span>
<a name="l00575"></a>00575                         <span class="keywordflow">if</span>(restart_left_mv_control&gt;=params-&gt;<a class="code" href="structtabu__search__params.html#99f7722db0a085595b1c3d6858c92695">change_move_limit</a>)
<a name="l00576"></a>00576                         {
<a name="l00577"></a>00577                                 key[1]=best_left-&gt;<a class="code" href="structbest__result.html#ab2b928ff847997f138d79954f51466a">key</a>[1];
<a name="l00578"></a>00578                                 <a class="code" href="tabu__search_8c.html#8e490df058e9d3e2ed1436b495ddb411">restart_tabu</a>(list_left,params);
<a name="l00579"></a>00579                                 <span class="keywordflow">if</span>(change_left_count%2!=0)
<a name="l00580"></a>00580                                 {
<a name="l00581"></a>00581                                         move_left-&gt;<a class="code" href="structtabu__movement.html#d2ab26b6f7904a7f8e8cce8642e8e9d1">move</a>=(<span class="keywordtype">void</span> *)&amp;<a class="code" href="tabu__search_8c.html#6923e47c8f97b184b285c378c83a2a81">move_alpha</a>;
<a name="l00582"></a>00582                                 }
<a name="l00583"></a>00583                                 <span class="keywordflow">else</span>
<a name="l00584"></a>00584                                 {
<a name="l00585"></a>00585                                         move_left-&gt;<a class="code" href="structtabu__movement.html#d2ab26b6f7904a7f8e8cce8642e8e9d1">move</a>=(<span class="keywordtype">void</span> *)&amp;<a class="code" href="tabu__search_8c.html#76650d01d07a956f2aa789c77a8a323d">move_beta</a>;
<a name="l00586"></a>00586                                 }
<a name="l00587"></a>00587                                 change_left_count++;
<a name="l00588"></a>00588                                 restart_left_mv_control=0;
<a name="l00589"></a>00589                         }
<a name="l00590"></a>00590                         <span class="comment">/* just move */</span>
<a name="l00591"></a>00591                         <span class="keywordflow">if</span>(report-&gt;<a class="code" href="structoutput__report.html#67d9286ad83a76c54b74947442818b13">options</a>-&gt;<a class="code" href="structinput__opt.html#72693fd567f8d713a3abdf5843b8013e">paranoid_leve</a>&gt;0)
<a name="l00592"></a>00592                         {
<a name="l00593"></a>00593                                 report-&gt;<a class="code" href="structoutput__report.html#082bbb7450420c6939c5c3ddef1d2127">par</a>-&gt;<a class="code" href="structparanoid__level.html#55fda2bb992bd5b9627e69828e7cfe8d">key</a>=key[1];
<a name="l00594"></a>00594                                 report-&gt;<a class="code" href="structoutput__report.html#082bbb7450420c6939c5c3ddef1d2127">par</a>-&gt;<a class="code" href="structparanoid__level.html#41c5e85c9fe94a6f83e91856de236198">block</a>=<a class="code" href="tabu__search_8h.html#437ef08681e7210d6678427030446a54">LEFT</a>;
<a name="l00595"></a>00595                                 report-&gt;<a class="code" href="structoutput__report.html#082bbb7450420c6939c5c3ddef1d2127">par</a>-&gt;<a class="code" href="structparanoid__level.html#29707d1f0e746bf4015cc96f95a46904">tabu</a>=control_left;
<a name="l00596"></a>00596                                 report-&gt;<a class="code" href="structoutput__report.html#082bbb7450420c6939c5c3ddef1d2127">par</a>-&gt;<a class="code" href="structparanoid__level.html#35354b4765bcc99168d789d76b419ffd">list</a>=list_left;
<a name="l00597"></a>00597                         }
<a name="l00598"></a>00598                         (report-&gt;<a class="code" href="structoutput__report.html#226f04f2cd3bb76a609872d69149fbef">print_paranoid</a>)(report-&gt;<a class="code" href="structoutput__report.html#082bbb7450420c6939c5c3ddef1d2127">par</a>,stderr);
<a name="l00599"></a>00599                         (move_left-&gt;<a class="code" href="structtabu__movement.html#d2ab26b6f7904a7f8e8cce8642e8e9d1">move</a>)(key,list_left,&amp;mistakes_left,&amp;control_left,&amp;founded_left,best_left,params,report,cpmess,<a class="code" href="tabu__search_8h.html#437ef08681e7210d6678427030446a54">LEFT</a>);
<a name="l00600"></a>00600                         (report-&gt;<a class="code" href="structoutput__report.html#77e256591286f5d9cb37065a6768e17e">print_iteration</a>)(best_left,<a class="code" href="tabu__search_8h.html#437ef08681e7210d6678427030446a54">LEFT</a>,i+1,stderr);
<a name="l00601"></a>00601                         
<a name="l00602"></a>00602                         <span class="comment">/*</span>
<a name="l00603"></a>00603 <span class="comment">                         * Convergency condition and restart condition for left block key</span>
<a name="l00604"></a>00604 <span class="comment">                         */</span>
<a name="l00605"></a>00605                         
<a name="l00606"></a>00606                         <span class="keywordflow">if</span>((best_left-&gt;value)&gt;=<a class="code" href="tabu__search_8h.html#09d0783ba1b848bf34d6fa350c968b9b">TABU_END_LIMIT</a>)
<a name="l00607"></a>00607                         {
<a name="l00608"></a>00608                                 time(&amp;end_left_seconds);
<a name="l00609"></a>00609                                 left_clock=clock();
<a name="l00610"></a>00610                                 left_iter=i+1;
<a name="l00611"></a>00611                                 founded_left=<a class="code" href="types_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00612"></a>00612                                 bit=1;
<a name="l00613"></a>00613                                 bit=bit&lt;&lt;31;
<a name="l00614"></a>00614                                 <span class="comment">/* a tricky 31th bit swap */</span>
<a name="l00615"></a>00615                         <span class="comment">/*      if(!((best_left-&gt;key[1]&amp;bit)&amp;&amp;(best_left-&gt;key[1]&amp;bit&lt;&lt;1))&amp;&amp;!(((best_left-&gt;key[1]^LONG_MAX)&amp;bit)&amp;&amp;((best_left-&gt;key[1]^LONG_MAX)&amp;bit&lt;&lt;1))){</span>
<a name="l00616"></a>00616 <span class="comment">                                        best_left-&gt;key[1]=best_left-&gt;key[1]^bit;</span>
<a name="l00617"></a>00617 <span class="comment">                                        best_left-&gt;key[1]=best_left-&gt;key[1]^bit&lt;&lt;1;</span>
<a name="l00618"></a>00618 <span class="comment">                                }*/</span>
<a name="l00619"></a>00619 
<a name="l00620"></a>00620                         }
<a name="l00621"></a>00621                         <span class="keywordflow">if</span>(mistakes_left&gt;=params-&gt;tabu_max_decrease)
<a name="l00622"></a>00622                         {
<a name="l00623"></a>00623                                 restart_left_control++;
<a name="l00624"></a>00624                                 restart_left_mv_control++;
<a name="l00625"></a>00625                                 <a class="code" href="tabu__search_8c.html#604e01b3e69cad37a3584109f91d8f8c">restart_left</a>(key);
<a name="l00626"></a>00626                                 <span class="keywordflow">if</span>(<a class="code" href="tabu__search_8c.html#2567977f08461ce4a78dc7ac1d15f136">evaluate</a>(key[1],cpmess,<a class="code" href="tabu__search_8h.html#437ef08681e7210d6678427030446a54">LEFT</a>,report,params)&gt;=best_left-&gt;value)
<a name="l00627"></a>00627                                 {
<a name="l00628"></a>00628                                         best_left-&gt;key[0]=key[0];
<a name="l00629"></a>00629                                         best_left-&gt;key[1]=key[1];
<a name="l00630"></a>00630                                         best_left-&gt;bit=0;
<a name="l00631"></a>00631                                         best_left-&gt;value=<a class="code" href="tabu__search_8c.html#2567977f08461ce4a78dc7ac1d15f136">evaluate</a>(key[1],cpmess,<a class="code" href="tabu__search_8h.html#437ef08681e7210d6678427030446a54">LEFT</a>,report,params);
<a name="l00632"></a>00632                                 }
<a name="l00633"></a>00633                                 <a class="code" href="tabu__search_8c.html#8e490df058e9d3e2ed1436b495ddb411">restart_tabu</a>(list_left,params);
<a name="l00634"></a>00634                                 mistakes_left=0;
<a name="l00635"></a>00635                         }
<a name="l00636"></a>00636                 }
<a name="l00637"></a>00637 
<a name="l00638"></a>00638                 <span class="keywordflow">if</span>(founded_right==<a class="code" href="types_8h.html#a93f0eb578d23995850d61f7d61c55c1">FALSE</a>)
<a name="l00639"></a>00639                 {
<a name="l00640"></a>00640                         <span class="comment">/*</span>
<a name="l00641"></a>00641 <span class="comment">                         *Individual movement selection for right key block</span>
<a name="l00642"></a>00642 <span class="comment">                         */</span>
<a name="l00643"></a>00643                         <span class="keywordflow">if</span>(restart_right_mv_control&gt;=params-&gt;change_move_limit)
<a name="l00644"></a>00644                         {
<a name="l00645"></a>00645                                 key[3]=best_right-&gt;key[1];
<a name="l00646"></a>00646                                 <a class="code" href="tabu__search_8c.html#8e490df058e9d3e2ed1436b495ddb411">restart_tabu</a>(list_right,params);
<a name="l00647"></a>00647                                 <span class="keywordflow">if</span>(change_right_count%2==0)
<a name="l00648"></a>00648                                         move_right-&gt;move=(<span class="keywordtype">void</span> *)&amp;<a class="code" href="tabu__search_8c.html#6923e47c8f97b184b285c378c83a2a81">move_alpha</a>;
<a name="l00649"></a>00649                                 <span class="keywordflow">else</span>
<a name="l00650"></a>00650                                         move_right-&gt;move=(<span class="keywordtype">void</span> *)&amp;<a class="code" href="tabu__search_8c.html#76650d01d07a956f2aa789c77a8a323d">move_beta</a>;
<a name="l00651"></a>00651                                 change_right_count++;
<a name="l00652"></a>00652                                 restart_right_mv_control=0;
<a name="l00653"></a>00653                         }
<a name="l00654"></a>00654                         <span class="comment">/* just move */</span>
<a name="l00655"></a>00655                         <span class="keywordflow">if</span>(report-&gt;options-&gt;paranoid_leve&gt;0)
<a name="l00656"></a>00656                         {
<a name="l00657"></a>00657                                 report-&gt;par-&gt;key=key[3];
<a name="l00658"></a>00658                                 report-&gt;par-&gt;block=<a class="code" href="tabu__search_8h.html#80fb826a684cf3f0d306b22aa100ddac">RIGHT</a>;
<a name="l00659"></a>00659                                 report-&gt;par-&gt;tabu=control_right;
<a name="l00660"></a>00660                                 report-&gt;par-&gt;list=list_right;
<a name="l00661"></a>00661                         }
<a name="l00662"></a>00662                         (report-&gt;print_paranoid)(report-&gt;par,stderr);
<a name="l00663"></a>00663                         (move_right-&gt;move)(key,list_right,&amp;mistakes_right,&amp;control_right,&amp;founded_right,best_right,params,report,cpmess,<a class="code" href="tabu__search_8h.html#80fb826a684cf3f0d306b22aa100ddac">RIGHT</a>);
<a name="l00664"></a>00664                         (report-&gt;print_iteration)(best_right,<a class="code" href="tabu__search_8h.html#80fb826a684cf3f0d306b22aa100ddac">RIGHT</a>,i+1,stderr);
<a name="l00665"></a>00665 
<a name="l00666"></a>00666                         <span class="comment">/*</span>
<a name="l00667"></a>00667 <span class="comment">                         * Convergency condition and restart condition for right block key</span>
<a name="l00668"></a>00668 <span class="comment">                         */</span>
<a name="l00669"></a>00669                         <span class="keywordflow">if</span>((best_right-&gt;value)&gt;=<a class="code" href="tabu__search_8h.html#09d0783ba1b848bf34d6fa350c968b9b">TABU_END_LIMIT</a>)
<a name="l00670"></a>00670                         {
<a name="l00671"></a>00671                                 time(&amp;end_right_seconds);
<a name="l00672"></a>00672                                 right_clock=clock();
<a name="l00673"></a>00673                                 right_iter=i+1;
<a name="l00674"></a>00674                                 founded_right=<a class="code" href="types_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;
<a name="l00675"></a>00675                                 bit=1;
<a name="l00676"></a>00676                                 bit=bit&lt;&lt;31;
<a name="l00677"></a>00677                                 <span class="comment">/* a tricky 31th bit swap */</span>
<a name="l00678"></a>00678                         <span class="comment">/*      if(!((best_right-&gt;key[1]&amp;bit)&amp;&amp;(best_right-&gt;key[1]&amp;bit&lt;&lt;1))&amp;&amp;!(((best_right-&gt;key[1]^LONG_MAX)&amp;bit)&amp;&amp;((best_right-&gt;key[1]^LONG_MAX)&amp;bit&lt;&lt;1))){</span>
<a name="l00679"></a>00679 <span class="comment">                                        best_right-&gt;key[1]=best_left-&gt;key[1]^bit;</span>
<a name="l00680"></a>00680 <span class="comment">                                        best_right-&gt;key[1]=best_left-&gt;key[1]^bit&lt;&lt;1;</span>
<a name="l00681"></a>00681 <span class="comment">                                }*/</span>
<a name="l00682"></a>00682                                 
<a name="l00683"></a>00683                         }
<a name="l00684"></a>00684                         <span class="keywordflow">if</span>(mistakes_right&gt;=params-&gt;tabu_max_decrease)
<a name="l00685"></a>00685                         {
<a name="l00686"></a>00686                                 restart_right_control++;
<a name="l00687"></a>00687                                 restart_right_mv_control++;
<a name="l00688"></a>00688                                 <a class="code" href="tabu__search_8c.html#83abceae193775a353209e70e7c692d6">restart_right</a>(key);
<a name="l00689"></a>00689                                 <span class="keywordflow">if</span>(<a class="code" href="tabu__search_8c.html#2567977f08461ce4a78dc7ac1d15f136">evaluate</a>(key[3],cpmess,<a class="code" href="tabu__search_8h.html#80fb826a684cf3f0d306b22aa100ddac">RIGHT</a>,report,params)&gt;=best_right-&gt;value)
<a name="l00690"></a>00690                                 {
<a name="l00691"></a>00691                                         best_right-&gt;key[0]=key[2];
<a name="l00692"></a>00692                                         best_right-&gt;key[1]=key[3];
<a name="l00693"></a>00693                                         best_right-&gt;bit=0;
<a name="l00694"></a>00694                                         best_right-&gt;value=<a class="code" href="tabu__search_8c.html#2567977f08461ce4a78dc7ac1d15f136">evaluate</a>(key[3],cpmess,<a class="code" href="tabu__search_8h.html#80fb826a684cf3f0d306b22aa100ddac">RIGHT</a>,report,params);
<a name="l00695"></a>00695                                 }
<a name="l00696"></a>00696                                 <a class="code" href="tabu__search_8c.html#8e490df058e9d3e2ed1436b495ddb411">restart_tabu</a>(list_right,params);
<a name="l00697"></a>00697                                 mistakes_right=0;
<a name="l00698"></a>00698                         }
<a name="l00699"></a>00699                 }
<a name="l00700"></a>00700                 <span class="comment">/* if the left and right block converges, then stop */</span>
<a name="l00701"></a>00701                 <span class="keywordflow">if</span>(founded_left==<a class="code" href="types_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>&amp;&amp;founded_right==<a class="code" href="types_8h.html#a8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>)
<a name="l00702"></a>00702                 {
<a name="l00703"></a>00703                         <span class="keywordflow">break</span>;
<a name="l00704"></a>00704                 }
<a name="l00705"></a>00705                 
<a name="l00706"></a>00706         }
<a name="l00707"></a>00707         
<a name="l00708"></a>00708         <span class="keywordflow">if</span>(report-&gt;options-&gt;paranoid_leve&gt;0)
<a name="l00709"></a>00709         {
<a name="l00710"></a>00710                 free((<span class="keywordtype">char</span> *)report-&gt;par);
<a name="l00711"></a>00711         }
<a name="l00712"></a>00712         
<a name="l00713"></a>00713         <span class="keywordflow">if</span>(founded_left==<a class="code" href="types_8h.html#a93f0eb578d23995850d61f7d61c55c1">FALSE</a>)
<a name="l00714"></a>00714         {
<a name="l00715"></a>00715                 time(&amp;end_left_seconds);
<a name="l00716"></a>00716                 left_clock=clock();
<a name="l00717"></a>00717                 left_iter=i;
<a name="l00718"></a>00718         }
<a name="l00719"></a>00719 
<a name="l00720"></a>00720         <span class="keywordflow">if</span>(founded_right==<a class="code" href="types_8h.html#a93f0eb578d23995850d61f7d61c55c1">FALSE</a>)
<a name="l00721"></a>00721         {
<a name="l00722"></a>00722                 time(&amp;end_right_seconds);
<a name="l00723"></a>00723                 right_clock=clock();
<a name="l00724"></a>00724                 right_iter=i;
<a name="l00725"></a>00725         }
<a name="l00726"></a>00726 
<a name="l00727"></a>00727         time(&amp;end_global_seconds);
<a name="l00728"></a>00728         global_clock=clock();
<a name="l00729"></a>00729                 
<a name="l00730"></a>00730         <a class="code" href="tea_8c.html#807528dd32c2845934d7ceca16d31728">gamma_tea</a>(cpmess[0].plain_message,cpmess[0].cipher_message,best_left-&gt;key);
<a name="l00731"></a>00731         key[2]=best_right-&gt;key[0];
<a name="l00732"></a>00732         key[3]=best_right-&gt;key[1];
<a name="l00733"></a>00733         <a class="code" href="tea_8c.html#6d383edb519fb59fe865b83d25512ae9">delta_tea</a>(cpmess[0].plain_message,cpmess[0].cipher_message,key);
<a name="l00734"></a>00734         best_right-&gt;key[0]=key[2];
<a name="l00735"></a>00735         
<a name="l00736"></a>00736         <span class="keywordflow">if</span>((report_final=<a class="code" href="types_8h.html#137ef1902042f87f3eba5d1c3b2a0638">MALLOC</a>(<a class="code" href="structfinal__report.html">final_report</a>))==NULL)
<a name="l00737"></a>00737         {
<a name="l00738"></a>00738                 fprintf(stderr,<span class="stringliteral">"ERROR: FAILED TO ALLOCATE MEMORY\n"</span>);
<a name="l00739"></a>00739                 exit(1);
<a name="l00740"></a>00740         }
<a name="l00741"></a>00741         <span class="comment">/* mold final report structure */</span>
<a name="l00742"></a>00742         report_final-&gt;left=best_left;
<a name="l00743"></a>00743         report_final-&gt;right=best_right;
<a name="l00744"></a>00744         report_final-&gt;init_left=init_left_seconds;
<a name="l00745"></a>00745         report_final-&gt;init_right=init_right_seconds;
<a name="l00746"></a>00746         report_final-&gt;init_global=init_global_seconds;
<a name="l00747"></a>00747         report_final-&gt;end_left=end_left_seconds;
<a name="l00748"></a>00748         report_final-&gt;end_right=end_right_seconds;
<a name="l00749"></a>00749         report_final-&gt;end_global=end_global_seconds;
<a name="l00750"></a>00750         report_final-&gt;clock_left=left_clock;
<a name="l00751"></a>00751         report_final-&gt;clock_right=right_clock;
<a name="l00752"></a>00752         report_final-&gt;clock_global=global_clock;
<a name="l00753"></a>00753         report_final-&gt;change_left_count=change_left_count;
<a name="l00754"></a>00754         report_final-&gt;change_right_count=change_right_count;
<a name="l00755"></a>00755         report_final-&gt;restart_left_control=restart_left_control;
<a name="l00756"></a>00756         report_final-&gt;restart_right_control=restart_right_control;
<a name="l00757"></a>00757         report_final-&gt;left_iter=left_iter;
<a name="l00758"></a>00758         report_final-&gt;right_iter=right_iter;
<a name="l00759"></a>00759         
<a name="l00760"></a>00760         (report-&gt;print_end)(report_final,stdout);
<a name="l00761"></a>00761         <span class="keywordflow">if</span>(report-&gt;options-&gt;save_output)
<a name="l00762"></a>00762                 (report-&gt;print_end)(report_final,report-&gt;report_file);
<a name="l00763"></a>00763                 
<a name="l00764"></a>00764         <span class="comment">/* free all used memory */</span>
<a name="l00765"></a>00765         <a class="code" href="tabu__search_8c.html#0c7f03af2ae6b5cb027897527add2379">free_tabu</a>(list_right-&gt;next,list_right-&gt;name);
<a name="l00766"></a>00766         <a class="code" href="tabu__search_8c.html#0c7f03af2ae6b5cb027897527add2379">free_tabu</a>(list_left-&gt;next,list_left-&gt;name);
<a name="l00767"></a>00767         free((<span class="keywordtype">char</span> *)list_right);
<a name="l00768"></a>00768         free((<span class="keywordtype">char</span> *)list_left);
<a name="l00769"></a>00769         free((<span class="keywordtype">char</span> *)best_right);
<a name="l00770"></a>00770         free((<span class="keywordtype">char</span> *)best_left);
<a name="l00771"></a>00771         free((<span class="keywordtype">char</span> *)params);
<a name="l00772"></a>00772         free((<span class="keywordtype">char</span> *)move_left);
<a name="l00773"></a>00773         free((<span class="keywordtype">char</span> *)move_right);
<a name="l00774"></a>00774         free((<span class="keywordtype">char</span> *)report_final);
<a name="l00775"></a>00775 }
<a name="l00780"></a><a class="code" href="tabu__search_8h.html#0f429d71f81a803d1c7dc864900a9ca1">00780</a> <span class="keywordtype">void</span> <a class="code" href="tabu__search_8c.html#6527a198a1e034d0278b98165288abf8">generate_initial_solution</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *key)
<a name="l00781"></a>00781 {
<a name="l00782"></a>00782         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> randomic;
<a name="l00783"></a>00783         time_t seconds;
<a name="l00784"></a>00784         time(&amp;seconds);
<a name="l00785"></a>00785         srand((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) seconds+key[0]);
<a name="l00786"></a>00786         rand();
<a name="l00787"></a>00787         <span class="keywordflow">if</span>((randomic=rand())&gt;0)
<a name="l00788"></a>00788         {
<a name="l00789"></a>00789                 key[2]=(<span class="keywordtype">unsigned</span> long)randomic;
<a name="l00790"></a>00790         }
<a name="l00791"></a>00791         <span class="keywordflow">if</span>((randomic=rand())&gt;0)
<a name="l00792"></a>00792         {
<a name="l00793"></a>00793                 key[3]=(<span class="keywordtype">unsigned</span> long)randomic;
<a name="l00794"></a>00794         }
<a name="l00795"></a>00795         <span class="keywordflow">if</span>((randomic=rand())&gt;0)
<a name="l00796"></a>00796         {
<a name="l00797"></a>00797                 key[1]=(<span class="keywordtype">unsigned</span> long)randomic;
<a name="l00798"></a>00798         }
<a name="l00799"></a>00799         <span class="keywordflow">if</span>((randomic=rand())&gt;0)
<a name="l00800"></a>00800         {
<a name="l00801"></a>00801                 key[0]=(<span class="keywordtype">unsigned</span> long)randomic;
<a name="l00802"></a>00802         }
<a name="l00803"></a>00803 }
<a name="l00808"></a><a class="code" href="tabu__search_8h.html#90baf53cad3e2734a557c4b91bdbadd1">00808</a> <span class="keywordtype">void</span> <a class="code" href="tabu__search_8c.html#604e01b3e69cad37a3584109f91d8f8c">restart_left</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *key)
<a name="l00809"></a>00809 {
<a name="l00810"></a>00810         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> randomic;
<a name="l00811"></a>00811         time_t seconds;
<a name="l00812"></a>00812         
<a name="l00813"></a>00813         time(&amp;seconds);
<a name="l00814"></a>00814         
<a name="l00815"></a>00815         srand((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) seconds+key[3]);
<a name="l00816"></a>00816         rand();
<a name="l00817"></a>00817         rand();
<a name="l00818"></a>00818         <span class="keywordflow">if</span>((randomic=rand())&gt;0)
<a name="l00819"></a>00819         {
<a name="l00820"></a>00820                 key[1]=(<span class="keywordtype">unsigned</span> long)randomic;
<a name="l00821"></a>00821         }
<a name="l00822"></a>00822         <span class="keywordflow">else</span>
<a name="l00823"></a>00823         {
<a name="l00824"></a>00824                 key[1]=key[1]&lt;&lt;1;
<a name="l00825"></a>00825         }
<a name="l00826"></a>00826 }
<a name="l00831"></a><a class="code" href="tabu__search_8h.html#5ba04409faab868f0bf091f8b7739022">00831</a> <span class="keywordtype">void</span> <a class="code" href="tabu__search_8c.html#83abceae193775a353209e70e7c692d6">restart_right</a>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *key)
<a name="l00832"></a>00832 {
<a name="l00833"></a>00833         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> randomic;
<a name="l00834"></a>00834         time_t seconds;
<a name="l00835"></a>00835         
<a name="l00836"></a>00836         time(&amp;seconds);
<a name="l00837"></a>00837         
<a name="l00838"></a>00838         srand((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) seconds+key[0]);
<a name="l00839"></a>00839         rand();
<a name="l00840"></a>00840         rand();
<a name="l00841"></a>00841         <span class="keywordflow">if</span>((randomic=rand())&gt;0)
<a name="l00842"></a>00842         {
<a name="l00843"></a>00843                 key[3]=(<span class="keywordtype">unsigned</span> long)randomic;
<a name="l00844"></a>00844         }
<a name="l00845"></a>00845         <span class="keywordflow">else</span>
<a name="l00846"></a>00846         {
<a name="l00847"></a>00847                 key[3]=key[3]&gt;&gt;1;
<a name="l00848"></a>00848         }
<a name="l00849"></a>00849 }
<a name="l00854"></a><a class="code" href="tabu__search_8h.html#e808274ca16bb4390f92fc3bff538049">00854</a> <a class="code" href="structtabu__search__params.html">ts_params</a> *<a class="code" href="tabu__search_8c.html#f4f7d6f12872c48af20f26b03f578217">create_params</a>(<a class="code" href="structinput__opt.html">input_options</a> *options)
<a name="l00855"></a>00855 {
<a name="l00856"></a>00856         <a class="code" href="structtabu__search__params.html">ts_params</a> *params;
<a name="l00857"></a>00857         <span class="keywordflow">if</span>(!((params=<a class="code" href="types_8h.html#137ef1902042f87f3eba5d1c3b2a0638">MALLOC</a>(<a class="code" href="structtabu__search__params.html">ts_params</a>))==NULL))
<a name="l00858"></a>00858         {
<a name="l00859"></a>00859                 <span class="keywordflow">if</span>(options-&gt;<a class="code" href="structinput__opt.html#957deaa30613c4cd539fccf4010e7797">tabu_list_length</a>==0)
<a name="l00860"></a>00860                 {
<a name="l00861"></a>00861                         params-&gt;<a class="code" href="structtabu__search__params.html#7f49d4ec523597ea9ddb839f80fbe2a8">tabu_list_length</a>=<a class="code" href="tabu__search_8h.html#f7cd3174de7e8534674e7b509e583dd8">DEFAULT_TABU_LIST_LENGTH</a>;
<a name="l00862"></a>00862                 }
<a name="l00863"></a>00863                 <span class="keywordflow">else</span>
<a name="l00864"></a>00864                 {
<a name="l00865"></a>00865                         params-&gt;<a class="code" href="structtabu__search__params.html#7f49d4ec523597ea9ddb839f80fbe2a8">tabu_list_length</a>=options-&gt;<a class="code" href="structinput__opt.html#957deaa30613c4cd539fccf4010e7797">tabu_list_length</a>;
<a name="l00866"></a>00866                 
<a name="l00867"></a>00867                 }
<a name="l00868"></a>00868                 <span class="keywordflow">if</span>(options-&gt;<a class="code" href="structinput__opt.html#80aac5cd53b832e55aecfbf3eb6eebfc">tabu_iterations</a>==0)
<a name="l00869"></a>00869                 {
<a name="l00870"></a>00870                         params-&gt;<a class="code" href="structtabu__search__params.html#963570c3e1373876501280de48cdc069">tabu_iterations</a>=<a class="code" href="tabu__search_8h.html#8b6656942128ebcf4fd59fcb595ca44c">DEFAULT_TABU_CYCLES</a>;
<a name="l00871"></a>00871                 }
<a name="l00872"></a>00872                 <span class="keywordflow">else</span>
<a name="l00873"></a>00873                 {
<a name="l00874"></a>00874                         params-&gt;<a class="code" href="structtabu__search__params.html#963570c3e1373876501280de48cdc069">tabu_iterations</a>=options-&gt;<a class="code" href="structinput__opt.html#80aac5cd53b832e55aecfbf3eb6eebfc">tabu_iterations</a>;
<a name="l00875"></a>00875                 }
<a name="l00876"></a>00876                 <span class="keywordflow">if</span>(options-&gt;<a class="code" href="structinput__opt.html#5ba7a73b8494ebd53a787271150e2c64">tabu_max_decrease</a>==0)
<a name="l00877"></a>00877                 {
<a name="l00878"></a>00878                         params-&gt;<a class="code" href="structtabu__search__params.html#8a1dba0292923ac0205357a7e13cf7ea">tabu_max_decrease</a>=<a class="code" href="tabu__search_8h.html#a605684df54be4c2b8a511a6cafad5f7">DEFAULT_TABU_RESTART_LIMIT</a>;
<a name="l00879"></a>00879                 }
<a name="l00880"></a>00880                 <span class="keywordflow">else</span>
<a name="l00881"></a>00881                 {
<a name="l00882"></a>00882                         params-&gt;<a class="code" href="structtabu__search__params.html#8a1dba0292923ac0205357a7e13cf7ea">tabu_max_decrease</a>=options-&gt;<a class="code" href="structinput__opt.html#5ba7a73b8494ebd53a787271150e2c64">tabu_max_decrease</a>;
<a name="l00883"></a>00883                 }
<a name="l00884"></a>00884                 <span class="keywordflow">if</span>(options-&gt;<a class="code" href="structinput__opt.html#961a32fe667f5a1c0dba56601a97065e">change_move_limit</a>==0)
<a name="l00885"></a>00885                 {
<a name="l00886"></a>00886                         params-&gt;<a class="code" href="structtabu__search__params.html#99f7722db0a085595b1c3d6858c92695">change_move_limit</a>=<a class="code" href="tabu__search_8h.html#22a84544a0644b929978be6030d77525">CHANGE_MOVE_LIMIT</a>;
<a name="l00887"></a>00887                 }
<a name="l00888"></a>00888                 <span class="keywordflow">else</span>
<a name="l00889"></a>00889                 {
<a name="l00890"></a>00890                         params-&gt;<a class="code" href="structtabu__search__params.html#99f7722db0a085595b1c3d6858c92695">change_move_limit</a>=options-&gt;<a class="code" href="structinput__opt.html#961a32fe667f5a1c0dba56601a97065e">change_move_limit</a>;
<a name="l00891"></a>00891                 }
<a name="l00892"></a>00892                 <span class="keywordflow">if</span>(options-&gt;<a class="code" href="structinput__opt.html#e3eae3cf8661aabab1c630f0eb17dd7b">key_eval_percent</a>==0)
<a name="l00893"></a>00893                 {
<a name="l00894"></a>00894                         params-&gt;<a class="code" href="structtabu__search__params.html#4e6ab6880e04d25417ef1f04afc55bc5">key_eval_percent</a>=<a class="code" href="tabu__search_8h.html#4aa13986ded4b2718bb4693cbbcbe8e8">PERCENT_MULTI</a>; 
<a name="l00895"></a>00895                 }
<a name="l00896"></a>00896                 <span class="keywordflow">else</span>
<a name="l00897"></a>00897                 {
<a name="l00898"></a>00898                         params-&gt;<a class="code" href="structtabu__search__params.html#4e6ab6880e04d25417ef1f04afc55bc5">key_eval_percent</a>=options-&gt;<a class="code" href="structinput__opt.html#e3eae3cf8661aabab1c630f0eb17dd7b">key_eval_percent</a>;
<a name="l00899"></a>00899                 }
<a name="l00900"></a>00900         }
<a name="l00901"></a>00901         <span class="keywordflow">else</span>
<a name="l00902"></a>00902         {
<a name="l00903"></a>00903                 fprintf(stderr,<span class="stringliteral">"ERROR: FAILED TO ALLOCATE MEMORY\n"</span>);
<a name="l00904"></a>00904                 exit(1);
<a name="l00905"></a>00905         }
<a name="l00906"></a>00906         <span class="keywordflow">return</span>(params);
<a name="l00907"></a>00907 }
<a name="l00912"></a><a class="code" href="tabu__search_8h.html#e642877db980bdb7921e7f64b6e14c3f">00912</a> <a class="code" href="structtabu__list.html">tabu_list</a> *<a class="code" href="tabu__search_8c.html#ca35ea71a4b06484496f426aae819406">create_tabu_list</a>(<a class="code" href="structtabu__search__params.html">ts_params</a> *params)
<a name="l00913"></a>00913 {
<a name="l00914"></a>00914         
<a name="l00915"></a>00915         <span class="keywordtype">int</span> i;
<a name="l00916"></a>00916         <a class="code" href="structtabu__list.html">tabu_list</a> *tabu;
<a name="l00917"></a>00917         <a class="code" href="structtabu__list.html">tabu_list</a> *tabu_t;
<a name="l00918"></a>00918         
<a name="l00919"></a>00919         <span class="keywordflow">if</span>((tabu=<a class="code" href="types_8h.html#137ef1902042f87f3eba5d1c3b2a0638">MALLOC</a>(<a class="code" href="structtabu__list.html">tabu_list</a>))==NULL)
<a name="l00920"></a>00920         {
<a name="l00921"></a>00921                 fprintf(stderr,<span class="stringliteral">"ERROR: FAILED TO ALLOCATE MEMORY\n"</span>);
<a name="l00922"></a>00922                 exit(1);
<a name="l00923"></a>00923         }
<a name="l00924"></a>00924         tabu_t=tabu;
<a name="l00925"></a>00925         <span class="keywordflow">for</span>(i=0;i&lt;params-&gt;<a class="code" href="structtabu__search__params.html#7f49d4ec523597ea9ddb839f80fbe2a8">tabu_list_length</a>;i++)
<a name="l00926"></a>00926         {
<a name="l00927"></a>00927                 tabu_t-&gt;<a class="code" href="structtabu__list.html#2382a4d16d69f75b1e9c8b7d5402620d">key</a>=0x0;
<a name="l00928"></a>00928                 tabu_t-&gt;<a class="code" href="structtabu__list.html#07a15f07895c76ee5acf99b3a1cb77be">bit_position</a>=<a class="code" href="tabu__search_8h.html#30a84777ef6bc779f7c1c5942575a5fc">POST_LIMIT</a>;
<a name="l00929"></a>00929                 tabu_t-&gt;<a class="code" href="structtabu__list.html#970d82ef6764a9e18cdd6d2b90a66918">value</a>=0;
<a name="l00930"></a>00930                 tabu_t-&gt;<a class="code" href="structtabu__list.html#073f843ec54e110b184d4c0a0f0071db">name</a>=i;
<a name="l00931"></a>00931                 <span class="keywordflow">if</span>(i&lt;params-&gt;tabu_list_length-1){
<a name="l00932"></a>00932                         <span class="keywordflow">if</span>((tabu_t-&gt;<a class="code" href="structtabu__list.html#0e67af91d43756f1e998bd52351220df">next</a>=<a class="code" href="types_8h.html#137ef1902042f87f3eba5d1c3b2a0638">MALLOC</a>(<a class="code" href="structtabu__list.html">tabu_list</a>))==NULL)
<a name="l00933"></a>00933                         {
<a name="l00934"></a>00934                                 fprintf(stderr,<span class="stringliteral">"ERROR: FAILED TO ALLOCATE MEMORY\n"</span>);
<a name="l00935"></a>00935                                 exit(1);
<a name="l00936"></a>00936                         }
<a name="l00937"></a>00937                 }
<a name="l00938"></a>00938                 <span class="keywordflow">else</span>
<a name="l00939"></a>00939                 { 
<a name="l00940"></a>00940                         tabu_t-&gt;<a class="code" href="structtabu__list.html#0e67af91d43756f1e998bd52351220df">next</a>=tabu; 
<a name="l00941"></a>00941                         <span class="keywordflow">break</span>;
<a name="l00942"></a>00942                 }
<a name="l00943"></a>00943                 tabu_t=tabu_t-&gt;<a class="code" href="structtabu__list.html#0e67af91d43756f1e998bd52351220df">next</a>;
<a name="l00944"></a>00944         }
<a name="l00945"></a>00945         <span class="keywordflow">return</span>(tabu);
<a name="l00946"></a>00946 }
<a name="l00952"></a><a class="code" href="tabu__search_8h.html#e7d8544aa50768f9482e7384468b8622">00952</a> <span class="keywordtype">void</span> <a class="code" href="tabu__search_8c.html#8e490df058e9d3e2ed1436b495ddb411">restart_tabu</a>(<a class="code" href="structtabu__list.html">tabu_list</a> *tabu_t,<a class="code" href="structtabu__search__params.html">ts_params</a> *params)
<a name="l00953"></a>00953 {
<a name="l00954"></a>00954         <span class="keywordtype">int</span> i;
<a name="l00955"></a>00955         <span class="keywordflow">for</span>(i=0;i&lt;params-&gt;<a class="code" href="structtabu__search__params.html#7f49d4ec523597ea9ddb839f80fbe2a8">tabu_list_length</a>;i++)
<a name="l00956"></a>00956         {
<a name="l00957"></a>00957                 tabu_t-&gt;<a class="code" href="structtabu__list.html#2382a4d16d69f75b1e9c8b7d5402620d">key</a>=0;
<a name="l00958"></a>00958                 tabu_t-&gt;<a class="code" href="structtabu__list.html#07a15f07895c76ee5acf99b3a1cb77be">bit_position</a>=<a class="code" href="tabu__search_8h.html#30a84777ef6bc779f7c1c5942575a5fc">POST_LIMIT</a>;
<a name="l00959"></a>00959                 tabu_t-&gt;<a class="code" href="structtabu__list.html#970d82ef6764a9e18cdd6d2b90a66918">value</a>=0;
<a name="l00960"></a>00960                 tabu_t-&gt;<a class="code" href="structtabu__list.html#073f843ec54e110b184d4c0a0f0071db">name</a>=i;
<a name="l00961"></a>00961                 tabu_t=tabu_t-&gt;<a class="code" href="structtabu__list.html#0e67af91d43756f1e998bd52351220df">next</a>;
<a name="l00962"></a>00962         }
<a name="l00963"></a>00963 }
<a name="l00969"></a><a class="code" href="tabu__search_8h.html#75be52c5ec89dea0992d492ba753e9db">00969</a> <span class="keywordtype">void</span> <a class="code" href="tabu__search_8c.html#0c7f03af2ae6b5cb027897527add2379">free_tabu</a>(<a class="code" href="structtabu__list.html">tabu_list</a> *tabu,<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> name)
<a name="l00970"></a>00970 {
<a name="l00971"></a>00971         <span class="keywordflow">if</span>(tabu-&gt;<a class="code" href="structtabu__list.html#073f843ec54e110b184d4c0a0f0071db">name</a>==name)
<a name="l00972"></a>00972         {
<a name="l00973"></a>00973                 <span class="keywordflow">return</span>;
<a name="l00974"></a>00974         }
<a name="l00975"></a>00975         <span class="keywordflow">else</span>{
<a name="l00976"></a>00976                 <a class="code" href="tabu__search_8c.html#0c7f03af2ae6b5cb027897527add2379">free_tabu</a>(tabu-&gt;<a class="code" href="structtabu__list.html#0e67af91d43756f1e998bd52351220df">next</a>,name);
<a name="l00977"></a>00977                 free((<span class="keywordtype">char</span> *)tabu);
<a name="l00978"></a>00978         }
<a name="l00979"></a>00979 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Sat Jul 1 18:48:23 2006 for Tabu Search TEA by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.7 </small></address>
</body>
</html>
